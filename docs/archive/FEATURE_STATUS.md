# Qivr Feature Status & Integration Roadmap
*Last reviewed: September 23, 2025*

## Status legend
- âœ… Ready â€“ implemented and exercised end-to-end
- ğŸš§ Partial â€“ one side (backend/frontend) or critical wiring remains incomplete
- â›” Blocked â€“ no viable implementation available yet

## Feature matrix
| Feature slice | Backend status | Frontend status | Key blockers |
| --- | --- | --- | --- |
| Tenant context & authentication | ğŸš§ JWT claims and headers set the tenant, but the middleware still logs subdomains without resolving them to tenants, leaving multi-tenant isolation incomplete.ã€F:backend/Qivr.Api/Middleware/TenantMiddleware.csâ€ L46-L66ã€‘ | ğŸš§ Multiple API clients coexist; pages like the patient PROM view still import the legacy `services/apiClient` wrapper that lacks a base URL and tenant header logic.ã€F:apps/patient-portal/src/pages/PROMEnhanced.tsxâ€ L86-L118ã€‘ã€F:apps/patient-portal/src/services/apiClient.tsâ€ L14-L45ã€‘ | Implement subdomain lookup in the middleware and consolidate the portals onto the shared `lib/api-client` helper. |
| Clinic roster & operations | â›” `ClinicManagementController` responses are entirely mocked, so no clinics, providers, or stats can be managed via the API yet.ã€F:backend/Qivr.Api/Controllers/ClinicManagementController.csâ€ L33-L123ã€‘ | ğŸš§ UI screens exist but depend on the missing real data, preventing meaningful CRUD or analytics flows. | Replace controller TODOs with EF-backed queries and wire the dashboard to the new endpoints. |
| PROM lifecycle | âœ… `PromInstanceService` persists templates, instances, answers, reminders, and booking requests through EF and is registered in DI.ã€F:backend/Qivr.Services/PromInstanceService.csâ€ L32-L204ã€‘ã€F:backend/Qivr.Services/ServiceCollectionExtensions.csâ€ L28-L45ã€‘ | ğŸš§ The clinic PROM builder still generates fallback IDs like `q_<timestamp>` when `crypto.randomUUID` is unavailable, which violates the backend's GUID expectations documented in the PROM integration plan.ã€F:apps/clinic-dashboard/src/features/proms/components/PromBuilder.tsxâ€ L260-L290ã€‘ã€F:docs/proms-integration-plan.mdâ€ L1-L32ã€‘ | Enforce GUID generation on the client and align payloads with the EF-backed DTOs. |
| PROM analytics & follow-up | ğŸš§ Stats endpoints exist but depend on PROM submissions being recorded; clinic analytics still rely on future EF queries, and patient analytics omit vitals due to disabled branches.ã€F:backend/Qivr.Api/Controllers/AnalyticsController.csâ€ L42-L109ã€‘ | ğŸš§ The clinic analytics client continues to call legacy routes and fabricates PROM completion breakdowns when data is missing.ã€F:apps/clinic-dashboard/src/services/analyticsApi.tsâ€ L79-L142ã€‘ | Deliver real analytics queries and update the client to consume them without mock fallbacks. |
| Booking & scheduling | ğŸš§ PROM submissions can raise booking requests through the backend API, but there is no clinic workflow to review or convert them.ã€F:backend/Qivr.Api/Controllers/PromInstanceController.csâ€ L200-L247ã€‘ | â›” No UI exposes booking requests produced by PROMs; dashboards therefore lack the promised conversion insights. | Surface booking queues in the clinic dashboard and connect them to appointment creation. |
| Patient portal overview | ğŸš§ Backend endpoints for `/api/patient-dashboard/...` remain to be validated against the new data model. | â›” The dashboard page still targets legacy paths (`/dashboard/stats`, `/appointments/upcoming`, `/proms/pending`) that are not served by the current API, so cards remain empty.ã€F:apps/patient-portal/src/pages/Dashboard.tsxâ€ L70-L88ã€‘ | Implement aligned patient-facing endpoints and update the page to call them via the shared API client. |
| Intake automation | â›” `IntakeProcessingWorker` logs TODOs for AI triage, notifications, and record creation, so intakes never progress beyond placeholders.ã€F:backend/Qivr.Api/Workers/IntakeProcessingWorker.csâ€ L172-L210ã€‘ | ğŸš§ Intake queues surface in the UI but cannot reflect automated outcomes. | Complete the worker pipeline and expose status updates through the dashboard. |
| Notifications & messaging | ğŸš§ Entities and controllers exist, yet real-time delivery and cursor pagination still require verification against the latest Notification schema.ã€F:backend/Qivr.Api/Controllers/NotificationsController.csâ€ L1-L120ã€‘ | ğŸš§ No consolidated notification centre is wired up in either SPA. | Validate notification delivery and surface the inbox/badge UI. |

## Near-term integration goals
1. Replace the mocked clinic management responses with tenant-aware EF queries and plumb them into the dashboard.
2. Finish the PROM client alignment (GUIDs, payload shapes, analytics consumption) described in `proms-integration-plan.md` before expanding template features.
3. Stand up patient dashboard endpoints that match the portal's needs, then migrate the portal to the shared API client and updated routes.
4. Enable intake and booking follow-up loops so analytics can report real conversion and workload metrics.
